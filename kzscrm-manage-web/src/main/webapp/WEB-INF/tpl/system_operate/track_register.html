<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <title>跟踪登记</title>
	<link rel="stylesheet" href="/static/css/bootstrap/bootstrap.css">
    <link rel="stylesheet" href="/static/css/font-awesome/font-awesome.min.css">
    <link rel="stylesheet" href="/static/css/common.css">
    <link rel="stylesheet" href="/static/css/bootstrap/bootstrap-table.css">
    <link rel="stylesheet" href="/static/css/style.css">
    <link rel="stylesheet" href="/static/css/style2.css">
    <!--[if lt IE 9]>
        <script src="https://cdn.bootcss.com/html5shiv/r29/html5.js"></script>
        <script src="https://cdn.bootcss.com/respond.js/1.4.2/respond.js"></script>
    <![endif]-->
</head>
<body>
	<div class="second-page-header">
        <div class="container">
            <h2><a href="../../index.html">筷子说CRM</a></h2>
            <h3>跟踪登记</h3>
        </div>
    </div>
	<div class="second-page-bg">
        <div class="container second-page-body">
            <table
                id="table"
		        data-classes="table table-public"
		        data-toggle="table"
		        data-url="/crmbusinesstailrecord/trackRegisterDetails"
		        data-pagination="true"
		        data-pagination-v-align="both"
		        data-side-pagination="server"
		        data-cache="false"
		        data-query-params="queryParams"
		        data-page-size="20"
		        data-page-list="[10,20,50]">
                <thead>
                <tr>
                     <th data-field="businessName" data-align="center">业务员</th>
		            <th data-field="tailNature" data-align="center" data-formatter="tailNatureFormatter">跟踪性质</th>
		            <th data-field="tailTimeQuantum" data-align="center">时间</th>
		            <th data-field="accessName" data-align="center">对接人</th>
		            <th data-field="accessMobile" data-align="center">对接人电话</th>
		            <th data-field="remark" data-align="center" data-width="30%" style="position:relative">跟踪情况</th>
                </tr>
                </thead>
            </table>
            <form class="form-horizontal add-merchants" id="form" name="form" action="" method="post">
            	<input type="hidden" name="customerId" value="$!customerId">
			    <div class="form-group">
			        <div class="col-sm-3 text-right">
			            <label class="control-label" for="ctype">跟踪性质</label>
			        </div>
			        <div class="col-sm-5 has-feedback">
			            <select class="form-control selectarrow" name="tailNature" datatype="*" nullmsg="请选择跟踪性质" sucmsg=" ">
			                <option selected="selected" value="">请选择</option>
			                <option value="2">上门拜访</option>
			                <option value="1">电话联系</option>
			            </select>
			            <i class="fa fa-sort-down form-control-feedback triangle-fa"></i>
			        </div>
			        <div class="col-sm-3">
			            <div class="Validform_checktip"></div>
			        </div>
			    </div>
			    <div class="form-group">
			    	<div class="col-sm-3 text-right">
			            <label class="control-label" for="ctype">时间</label>
			        </div>
			        <div class="col-sm-5" style="white-space: nowrap;">
				        <input class="Wdate input-date" id="d4311" name="tailTimeStart" type="text" placeholder="请选择日期" onfocus="WdatePicker({dateFmt:'yyyy-MM-dd HH:mm:ss',maxDate:'#F{$dp.$D(\'d4312\')||\'2020-10-01\'}'})"style="width:175px!important;background: #fff url(/static/images/date-input.png) no-repeat 150px center !important;"  datatype="*" nullmsg="请选择日期" sucmsg=" ">
				        &nbsp;至&nbsp;
				        <input class="Wdate input-date" id="d4312" name="tailTimeEnd" type="text" placeholder="请选择日期" onfocus="WdatePicker({dateFmt:'yyyy-MM-dd HH:mm:ss',minDate:'#F{$dp.$D(\'d4311\')}',maxDate:'2020-10-01'})"style="width:175px!important;background: #fff url(/static/images/date-input.png) no-repeat 150px center !important;"  datatype="*" nullmsg="请选择日期" sucmsg=" ">
			    	</div>
			        <div class="col-sm-3">
			            <div class="Validform_checktip"></div>
			        </div>
			    </div>
			    <div class="form-group">
			        <div class="col-sm-3 text-right">
			            <label class="control-label" for="cname">对接人</label>
			        </div>
			        <div class="col-sm-5">
			            <input class="form-control" name="accessName" placeholder="请输入对接人" value="" datatype="*" nullmsg="对接人不能为空" sucmsg=" "/>
			        </div>
			        <div class="col-sm-3">                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
			            <div class="Validform_checktip"></div>
			        </div>
			    </div>
			    <div class="form-group">
			        <div class="col-sm-3 text-right">
			            <label class="control-label" for="cpho">对接人电话</label>
			        </div>
			        <div class="col-sm-5">
			            <input class="form-control" name="accessMobile" placeholder="请输入对接人电话" value="" datatype="customTel" nullmsg="对接人电话不能为空" errormsg="电话号码格式不正确" sucmsg=" ">
			        </div>
			        <div class="col-sm-3">
			            <div class="Validform_checktip"></div>
			        </div>
			    </div>
			    <div class="form-group geography">
			        <div class="col-sm-6 col-sm-offset-3">
			            <textarea name="remark" class="" placeholder="（请登记跟踪情况）" datatype="*" nullmsg="请登记跟踪情况" sucmsg=" "></textarea>
			        </div>
			        <div class="col-sm-3">
			            <div class="Validform_checktip"></div>
			        </div>
			    </div>
			    <div class="text-center mt40 pr">
			        <div class="shade-save"></div>
			        <a class="btn btn-warning save" href="javascript:void(0);">确定</a>
			    </div>
			</form>
        </div>
</div>


    <script src="/static/js/jquery/jquery-1.11.1.min.js"></script>
    <script src="$!rc.contextPath/static/js/layer/layer.js"></script>
    <script src="/static/js/bootstrap/bootstrap.min.js"></script>
    <script src="/static/js/ValidForm/Validform_v5.3.2.js"></script>
    <script src="/static/js/bootstrap/bootstrap-table.js"></script>
    <script src="/static/js/DatePicker/WdatePicker.js"></script>
    <script src="/static/js/bootstrap/bootstrap-table-zh-CN.js"></script>
    <script src="$!rc.contextPath/static/js/common.js"></script>
    <script src="$!rc.contextPath/static/js/tail_record/track_register.js"></script>
    <script type="text/javascript">
    var validForm = $('.form-horizontal').Validform({
        btnSubmit : ".save",
        tiptype : 2,
        datatype : {
            "nd":/^[0-9-]{8,}$/,
            "n11":/^(13[0-9]|14[5|7]|15[0|1|2|3|5|6|7|8|9]|17[0|1|3|5|6|7|8]|18[0|1|2|3|5|6|7|8|9])\d{8}$/,
            "customTel":function(gets,obj,curform,regxp){//自定义验证
            	var isPhone = /^([0-9]{3,4}-)?[0-9]{7,8}$/;
            	var isMob = /^(13[0-9]|14[5|7]|15[0|1|2|3|5|6|7|8|9]|17[0|1|3|5|6|7|8]|18[0|1|2|3|5|6|7|8|9])\d{8}$/;
            	if(isMob.test(gets)||isPhone.test(gets)){  
                    return true;  
                } else{  
                    return false;  
                }  
			}
        },
        postonce : true,
        ajaxPost : true,
        beforeCheck:function(){
        	return true;
        },
        callback : function(data) {
        	if (data.code == 0) {
				layer.msg("操作成功!",{
					  icon: 1,
					  time: 1000 //1秒关闭（如果不配置，默认是3秒）
					},function(){
					$("table").bootstrapTable('refresh');
					parent.layer.closeAll();
					window.close();
				},1);
			} else {
				layer.msg(data.desc);
			}
        }
    });
    var postData=$("#from").serialize();
    validForm.config({
        showAllError:true,
        url:"/crmbusinesstailrecord/saveTrackRegisterMsg",
        ajaxPost:{
            data:postData
        }
    });
	</script>
</body>
</html>
