<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
		<meta content="width=device-width, initial-scale=1, user-scalable=no" name="viewport">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		 <META HTTP-EQUIV="Pragma" CONTENT="no-cache">

		<META HTTP-EQUIV="Cache-Control" CONTENT="no-cache">
		
		<META HTTP-EQUIV="Expires" CONTENT="0">
        <title></title>
        <link rel="stylesheet" href="$!rc.contextPath/static/css/font-awesome/font-awesome.min.css">
        <link rel="stylesheet" href="$!rc.contextPath/static/css/bootstrap/bootstrap.min.css">
        <link rel="stylesheet" href="$!rc.contextPath/static/css/common.css">
        <link rel="stylesheet" href="$!rc.contextPath/static/css/style.css">
        
        <script src="$!rc.contextPath/static/js/jquery/jquery-1.11.1.min.js"></script>
        <script src="$!rc.contextPath/static/js/jquery/jquery-extend.js"></script>
        <script src="$!rc.contextPath/static/js/bootstrap/bootstrap.min.js"></script>
        <script src="$!rc.contextPath/static/js/layer/layer.js"></script>
        <script src="$!rc.contextPath/static/js/cityselect/jquery.cityselect.js"></script>
        <script src="$!rc.contextPath/static/js/ValidForm/Validform_v5.3.2.js"></script>       
        
    </head>
    <body>
		<form class="form-horizontal add-administrator" id="form" style="padding: 50px;">
			<div class="form-group">
				<div class="col-sm-2 col-sm-offset-2">
					<label class="control-label">用户名</label>
				</div>
				<div class="col-sm-5">
					<input class="form-control" placeholder="请输入姓名" id="userName" name="userName" datatype="zh2-10" value="$!crmUserVO.userName" nullmsg="姓名不能为空" errormsg="姓名格式不正确" sucmsg=""/>
				</div>
				<div class="col-sm-3">
					<div class="Validform_checktip"></div>
				</div>	
			</div>
			<div class="form-group">
				<div class="col-sm-2 col-sm-offset-2">
					<label class="control-label">电话号码</label>
				</div>
				<div class="col-sm-5">
					<input class="form-control" placeholder="该号码作为登录帐号" id="mobilephone" name="mobilephone" value="$!crmUserVO.mobilephone" datatype="n11" nullmsg="电话号码不能为空" errormsg="电话号码格式不正确" sucmsg=""/>
				</div>
				<div class="col-sm-3">
					<div class="Validform_checktip"></div>
				</div>	
			</div>
			<!-- <div class="form-group" id="accountGroup">
				<div class="col-sm-2 col-sm-offset-2">
					<label class="control-label">账号</label>
				</div>
				<div class="col-sm-5">
					<input class="form-control" placeholder="请输入帐号" id="account" name="account" #if($!crmUserVO.id) readonly #end value="$!crmUserVO.account" datatype="w4-16" nullmsg="帐号不能为空" errormsg="帐号格式不正确" sucmsg=""/>
				</div>
				<div class="col-sm-3">
					<div class="Validform_checktip"></div>
				</div>	
			</div> -->
			<!-- <div class="form-group">
				<div class="col-sm-2 col-sm-offset-2">
					<label class="control-label">密码</label>
				</div>
				<div class="col-sm-5">
					<input class="form-control" disabled="disabled" placeholder="请输入密码" type="password" id="password" name="password" #if($!crmUserVO.id) readonly #end value="$!crmUserVO.password" datatype="*" nullmsg="密码不能为空" errormsg="密码格式不正确" sucmsg=""/>
				</div>
				<div class="col-sm-3">
					<div class="Validform_checktip"></div>
				</div>	
			</div> -->
			#if(!$!crmUserVO.id)
				<!-- <div class="form-group">
					<div class="col-sm-2 col-sm-offset-2">
						<label class="control-label">确认密码</label>
					</div>
					<div class="col-sm-5">
						<input class="form-control" disabled="disabled" placeholder="请再输入一次" datatype="*" recheck="password" nullmsg="请再输入一次密码！" errormsg="您两次输入的账号密码不一致！" type="password" id="confirmPassword"/>
					</div>
					<div class="col-sm-3">
					<div class="Validform_checktip"></div>
				</div>
				</div> -->
			#end
			<div class="form-group">
				<div class="col-sm-2 col-sm-offset-2">
					<label class="control-label">用户角色</label>
				</div>
				<div class="col-sm-5 has-feedback">
					<select class="form-control" id="" name="roleId" datatype="*" nullmsg="请选择用户角色" sucmsg="" onchange="userTypeChange(this)">
						<option value="">--请选择角色--</option>
						#foreach($!crmPermRoleVO in $!crmPermRoleVOs)
						<option userType="$!crmPermRoleVO.userType" value="$!crmPermRoleVO.id" #if($!crmUserVO.roleId == $!crmPermRoleVO.id) selected="selected" #end >$!crmPermRoleVO.name</option>
						#end
					</select>
					<i class="fa fa-sort-down form-control-feedback triangle-fa"></i>
				</div>
				<div class="col-sm-3">
					<div class="Validform_checktip"></div>
				</div>	
			</div>
			<div class="form-group">
				<div class="col-sm-2 col-sm-offset-2">
					<label class="control-label">昵称</label>
				</div>
				<div class="col-sm-5">
					<input class="form-control" placeholder="请输入昵称" id="nickName" name="nickName" value="$!crmUserVO.nickName"/>
				</div>
				<div class="col-sm-3">
					<div class="Validform_checktip"></div>
				</div>	
			</div>
			
			<div class="form-group">
				<div class="col-sm-2 col-sm-offset-2">
					<label class="control-label">邮箱</label>
				</div>
				<div class="col-sm-5">
					<input class="form-control" placeholder="请输入邮箱" id="mail" name="mail" value="$!crmUserVO.mail" datatype="e" nullmsg="邮箱不能为空" errormsg="邮箱格式不正确" sucmsg=""/>
				</div>
				<div class="col-sm-3">
					<div class="Validform_checktip"></div>
				</div>	
			</div>
			<div class="form-group">
				<div class="col-sm-2 col-sm-offset-2 text-center">
					<label class="control-label">QQ</label>
				</div>
				<div class="col-sm-5">
					<input class="form-control" placeholder="请输入QQ账号" id="qq" name="qq" value="$!crmUserVO.qq"/>
				</div>
				<div class="col-sm-3">
					<div class="Validform_checktip"></div>
				</div>	
			</div>
			<div class="form-group">
				<div class="col-sm-2 col-sm-offset-2">
					<label class="control-label">地址</label>
				</div>
				<div class="col-sm-5">
					<input class="form-control" placeholder="请输入地址" id="address" name="address" value="$!crmUserVO.address" datatype="*" nullmsg="地址不能为空" errormsg="地址格式不正确" sucmsg=""/>
				</div>
				<div class="col-sm-3">
					<div class="Validform_checktip"></div>
				</div>	
			</div>
			<div class="form-group">
				<div class="col-sm-2 col-sm-offset-2">
					<label class="control-label">是否删除</label>
				</div>
				<div class="col-sm-2 has-feedback" style="padding-right:0">
					<select class="form-control" id="deleteFlag" name="delFlag" required>
						<option value="1" #if($!crmUserVO.delFlag==1) selected #end>否</option>
						<option value="0" #if($!crmUserVO.delFlag==0) selected #end>是</option>
					</select>
					<i class="fa fa-sort-down form-control-feedback triangle-fa"></i>
				</div>
			</div>
			<div class="text-center pr" style="margin-top: 50px;">
				<div class="shade-save"></div>
			#if($!crmUserVO.id)
				<a class="btn btn-warning save role_editRole" href="javascript:void(0);">确认修改</a>
				<input type="hidden" name="id" value="$!crmUserVO.id">
			#else
				<a class="btn btn-warning save role_newAdd_save" href="javascript:void(0);">确定保存</a>
			#end
			</div>
		</form>
			
         
		<script type="text/javascript">
			function userTypeChange(self){
				var userType=$(self).find('option:selected').attr("userType");
				//代理商
				if(userType==2){
					$('#accountGroup').hide();
					$('#mobilephone').attr('placeholder','请输入手机号码，该号码作为帐号登录');
					
				}else{
					$('#accountGroup').show();
					$('#mobilephone').attr('placeholder','请输入手机号码');
				}
			}
	        /* 表单验证-保存 */
		   	$('.save').click(function(){
		   		if($('.Validform_checktip').hasClass('.Validform_wrong')){
					$(this).prev().css('display','block');
				}
		    });
	        
		    var url=$.isEmptyObject('$!crmUserVO.id')&& "$!rc.contextPath/crmUser/doSave" || "$!rc.contextPath/crmUser/doUpdate"
		   	var validForm=$('.form-horizontal').Validform({
	           btnSubmit:".save",
	           tiptype:2,
	           datatype:{
	               "zh2-10":/^[\u4E00-\u9FA5\uf900-\ufa2d]{2,10}$/,
	               "zn":/^[\u4E00-\u9FA50-9]+$/,
	               "n11":/^(13[0-9]|14[5|7]|15[0|1|2|3|5|6|7|8|9]|17[0|1|3|5|6|7|8]|18[0|1|2|3|5|6|7|8|9])\d{8}$/,
	               "w4-16":/^[\w]{4,16}$/,
	               "n6-12":/^[\S]{6,12}$/,
	               "n4-12":/^[1-9]{1}[0-9]{3,11}$/
	           },
	           postonce:true,
	           ajaxPost:true,
	           ignoreHidden:true,
	           beforeCheck:function(curform){
	        	   validForm.config({
		   				showAllError:true,
		   				url:url,
		   				ajaxpost:{
		   					data:JSON.stringify($("#form").serializeJson()),
		   					contentType:"application/json;charset=UTF-8"
		   				}
	   				});
	        	   return true;
	           },
	           callback:function(data){
	               if(data && data.code==0){
	                   $('.save').prev().css('display','none');
	                   parent.$("table").bootstrapTable('refresh');
	                   parent.layer.closeAll();
	                   parent.layer.msg(data.desc);
	               }else{
	                   layer.msg(data.desc);
	                   $('.save').prev().css('display','none');
	               }
	           }
	       	});
		</script>
    </body>
</html>







